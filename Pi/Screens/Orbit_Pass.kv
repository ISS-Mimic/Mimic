#:kivy 2.2.0
#:import dp kivy.metrics.dp
#:import sp kivy.metrics.sp

# ----------------- Reusable scaled text styles -----------------
<LblTitle@Label>:
    font_size: sp(24) * root.ui_scale
    text_size: self.size
    halign: 'center'
    valign: 'middle'
    bold: True

<LblBig@Label>:
    font_size: sp(20) * root.ui_scale
    text_size: self.size
    halign: 'left'
    valign: 'middle'

<LblMed@Label>:
    font_size: sp(16) * root.ui_scale
    text_size: self.size
    halign: 'left'
    valign: 'middle'

<LblValue@Label>:
    font_size: sp(18) * root.ui_scale
    text_size: self.size
    halign: 'right'
    valign: 'middle'

<ActionBtn@Button>:
    size_hint_y: None
    height: dp(56)
    font_size: sp(18) * root.ui_scale
    padding: dp(12), dp(12)

# ----------------- Screen Layout -----------------
<Orbit_Pass>:
    on_size: root.on_size()

    BoxLayout:
        orientation: 'vertical'
        padding: dp(16)
        spacing: dp(12)

        # Top row: content
        BoxLayout:
            spacing: dp(16)

            # ---- LEFT: labels + sky chart ----
            BoxLayout:
                orientation: 'vertical'
                spacing: dp(10)
                size_hint_x: 0.66

                GridLayout:
                    cols: 2
                    size_hint_y: None
                    height: self.minimum_height
                    row_default_height: dp(28) * root.ui_scale
                    row_force_default: True
                    padding: 0, 0, dp(12), 0
                    spacing: dp(8)

                    LblMed:
                        text: "Start Time:"
                    LblValue:
                        id: start_time_value
                        text: "--:--"

                    LblMed:
                        text: "End Time:"
                    LblValue:
                        id: end_time_value
                        text: "--:--"

                    LblMed:
                        text: "Duration:"
                    LblValue:
                        id: duration_value
                        text: "--m"

                # Sky chart container
                Widget:
                    id: sky_chart_container
                    size_hint_y: 1
                    canvas.before:
                        Color:
                            rgba: 0.12, 0.12, 0.12, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

            # ---- RIGHT: Pass Details ----
            BoxLayout:
                orientation: 'vertical'
                size_hint_x: 0.34
                spacing: dp(8)
                padding: dp(8)

                LblTitle:
                    text: "Pass Details"
                    size_hint_y: None
                    height: dp(34) * root.ui_scale

                GridLayout:
                    cols: 2
                    row_default_height: dp(28) * root.ui_scale
                    row_force_default: True
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(6)

                    LblMed:
                        text: "Max Elevation"
                    LblValue:
                        id: max_elev_value
                        text: "--°"

                    LblMed:
                        text: "Start Direction"
                    LblValue:
                        id: start_dir_value
                        text: "--°"

                    LblMed:
                        text: "End Direction"
                    LblValue:
                        id: end_dir_value
                        text: "--°"

                    LblMed:
                        text: "Magnitude"
                    LblValue:
                        id: mag_value
                        text: "--"

                Widget:  # spacer
                    size_hint_y: 1

        # Bottom row: actions + status
        BoxLayout:
            size_hint_y: None
            height: dp(64) * root.ui_scale
            spacing: dp(12)

            ActionBtn:
                text: "Refresh Pass Data"
                on_release: root.refresh_pass_data()

            ActionBtn:
                text: "Update Location"
                on_release: root.update_location()

            Label:
                id: status_label
                text: root.status_text
                font_size: sp(16) * root.ui_scale
                color: 0.2, 1, 0.2, 1
                halign: 'center'
                valign: 'middle'
