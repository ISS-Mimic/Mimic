#:import dp kivy.metrics.dp

# --------------------------------------------------------------------------
#  Re-usable mixins (do not reference `root` here)
# --------------------------------------------------------------------------
<OrbitDataLabel@Label>:
    color: 1, 1, 1, 1
    font_size: min(self.height * 0.10, dp(24))
    size_hint_y: 0.4
    markup: True

<OrbitDataValue@Label>:
    color: 1, 1, 1, 1  # override per-instance with `color: root.signalcolor`
    font_size: min(self.height * 0.10, dp(24))
    size_hint_y: 0.4
    markup: True

<StateVectorLabel@Label>:
    color: 1, 1, 1, 1
    font_size: min(self.height * 0.10, dp(20))
    size_hint_y: 0.4
    markup: True

<StateVectorValue@Label>:
    color: 1, 1, 1, 1  # override per-instance with `color: root.signalcolor`
    font_size: min(self.height * 0.10, dp(20))
    size_hint_y: 0.4
    markup: True

# --------------------------------------------------------------------------
#  Orbit Data Screen — Detailed orbital mechanics display
# --------------------------------------------------------------------------
<Orbit_Data>:
    name: 'orbit_data'
    
    FloatLayout:
        # ───────────────────────── Background ──────────────────────────────
        Image:
            id: Orbit_Data_background
            source: f'{root.mimic_directory}/Mimic/Pi/imgs/orbit/OrbitDataBackground.png'
            fit_mode: "fill"
        
        # ─────────────────────── Orbital Elements ─────────────────────────
        # Semi Major Axis
        OrbitDataLabel:
            id: sma_label
            pos_hint: {"center_x": 0.7, "center_y": 0.81}
            text: 'Semi Major Axis:'
        
        OrbitDataValue:
            id: sma
            pos_hint: {"center_x": 0.9, "center_y": 0.81}
            text: '0'
            color: root.signalcolor
        
        # Eccentricity
        OrbitDataLabel:
            id: e_label
            pos_hint: {"center_x": 0.7, "center_y": 0.75}
            text: 'Eccentricity:'
        
        OrbitDataValue:
            id: e
            pos_hint: {"center_x": 0.9, "center_y": 0.75}
            text: '0'
            color: root.signalcolor
        
        # Inclination
        OrbitDataLabel:
            id: inc_label
            pos_hint: {"center_x": 0.7, "center_y": 0.69}
            text: 'Inclination (deg):'
        
        OrbitDataValue:
            id: inc
            pos_hint: {"center_x": 0.9, "center_y": 0.69}
            text: '0'
            color: root.signalcolor
        
        # Apogee
        OrbitDataLabel:
            id: apogee_label
            pos_hint: {"center_x": 0.7, "center_y": 0.63}
            text: 'Apogee (km):'
        
        OrbitDataValue:
            id: apogee_height
            pos_hint: {"center_x": 0.9, "center_y": 0.63}
            text: '0'
            color: root.signalcolor
        
        # Perigee
        OrbitDataLabel:
            id: perigee_label
            pos_hint: {"center_x": 0.7, "center_y": 0.57}
            text: 'Perigee (km):'
        
        OrbitDataValue:
            id: perigee_height
            pos_hint: {"center_x": 0.9, "center_y": 0.57}
            text: '0'
            color: root.signalcolor
        
        # Right Ascension of Ascending Node
        OrbitDataLabel:
            id: raan_label
            pos_hint: {"center_x": 0.7, "center_y": 0.51}
            text: 'Right Ascension (deg):'
        
        OrbitDataValue:
            id: raan
            pos_hint: {"center_x": 0.9, "center_y": 0.51}
            text: '0'
            color: root.signalcolor
        
        # Argument of Periapsis
        OrbitDataLabel:
            id: arg_per_label
            pos_hint: {"center_x": 0.7, "center_y": 0.45}
            text: 'Argument of Periapsis (deg):'
        
        OrbitDataValue:
            id: arg_per
            pos_hint: {"center_x": 0.9, "center_y": 0.45}
            text: '0'
            color: root.signalcolor
        
        # True Anomaly
        OrbitDataLabel:
            id: true_anomaly_label
            pos_hint: {"center_x": 0.7, "center_y": 0.39}
            text: 'True Anomaly (deg):'
        
        OrbitDataValue:
            id: true_anomaly
            pos_hint: {"center_x": 0.9, "center_y": 0.39}
            text: '0'
            color: root.signalcolor
        
        # ─────────────────────── State Vectors ────────────────────────────
        # Position State Vector
        StateVectorLabel:
            id: position_sv_label
            pos_hint: {"center_x": 0.2, "center_y": 0.29}
            text: 'Position State Vector:'
        
        StateVectorLabel:
            id: position_x_label
            pos_hint: {"center_x": 0.5, "center_y": 0.29}
            text: 'x   + '
        
        StateVectorValue:
            id: position_x
            pos_hint: {"center_x": 0.4, "center_y": 0.29}
            text: '0'
            color: root.signalcolor
        
        StateVectorLabel:
            id: position_y_label
            pos_hint: {"center_x": 0.7, "center_y": 0.29}
            text: 'y   + '
        
        StateVectorValue:
            id: position_y
            pos_hint: {"center_x": 0.6, "center_y": 0.29}
            text: '0'
            color: root.signalcolor
        
        StateVectorLabel:
            id: position_z_label
            pos_hint: {"center_x": 0.9, "center_y": 0.29}
            text: 'z      km'
        
        StateVectorValue:
            id: position_z
            pos_hint: {"center_x": 0.8, "center_y": 0.29}
            text: '0'
            color: root.signalcolor
        
        # Velocity State Vector
        StateVectorLabel:
            id: velocity_sv_label
            pos_hint: {"center_x": 0.2, "center_y": 0.23}
            text: 'Velocity State Vector:'
        
        StateVectorLabel:
            id: velocity_x_label
            pos_hint: {"center_x": 0.5, "center_y": 0.23}
            text: 'x   + '
        
        StateVectorValue:
            id: velocity_x
            pos_hint: {"center_x": 0.4, "center_y": 0.23}
            text: '0'
            color: root.signalcolor
        
        StateVectorLabel:
            id: velocity_label
            pos_hint: {"center_x": 0.7, "center_y": 0.23}
            text: 'y   + '
        
        StateVectorValue:
            id: velocity_y
            pos_hint: {"center_x": 0.6, "center_y": 0.23}
            text: '0'
            color: root.signalcolor
        
        StateVectorLabel:
            id: velocity_z_label
            pos_hint: {"center_x": 0.9, "center_y": 0.23}
            text: 'z      km/s'
        
        StateVectorValue:
            id: velocity_z
            pos_hint: {"center_x": 0.8, "center_y": 0.23}
            text: '0'
            color: root.signalcolor
        
        # ─────────────────────── Status Indicators ─────────────────────────
        Image:
            id: signal
            source: f"{root.mimic_directory}/Mimic/Pi/imgs/signal/signalred.zip"
            size_hint_y: 0.112
            anim_delay: 0.05
            anim_loop: 0
            fit_mode: "scale-down"
            pos_hint: {"center_x": 0.05, "center_y": 0.07}
        
        Image:
            id: arduino
            source: f"{root.mimic_directory}/Mimic/Pi/imgs/signal/arduino_offline.png"
            size_hint_y: 0.15
            anim_delay: 0.2
            anim_loop: 0
            fit_mode: "scale-down"
            pos_hint: {"center_x": 0.14, "center_y": 0.08}
        
        Label:
            id: arduino_count
            pos_hint: {"center_x": 0.14, "center_y": 0.08}
            text: ''
            markup: True
            color: 1, 1, 1, 1
            font_size: min(self.height * 0.3, dp(40))
            size_hint_y: 0.5
        
        # ─────────────────────── Navigation ────────────────────────────────
        Button:
            size_hint: 0.1, 0.11
            pos_hint: {"center_x": 0.9375, "center_y": 0.082}
            background_normal: f'{root.mimic_directory}/Mimic/Pi/imgs/eva/BackButton.png'
            on_release: app.root.current = 'orbit'
