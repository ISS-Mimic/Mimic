#:import dp kivy.metrics.dp

<ECLSS_Screen>:
    name: 'eclss'
    FloatLayout:
        Image:
            id: ECLSS_background
            source: f'{root.mimic_directory}/Mimic/Pi/imgs/eclss/ECLSSbackground.png'
            fit_mode: "fill"
        Button:
            background_normal: f'{root.mimic_directory}/Mimic/Pi/imgs/eclss/WRMunlit.png'
            background_down: f'{root.mimic_directory}/Mimic/Pi/imgs/eclss/WRMdown.png'
            size_hint: 0.15,0.13
            pos_hint: {"center_x": 0.6, "center_y": 0.9}
            on_release: root.manager.current = 'wrm'
        Button:
            background_normal: f'{root.mimic_directory}/Mimic/Pi/imgs/eclss/IATCSunlit.png'
            background_down: f'{root.mimic_directory}/Mimic/Pi/imgs/eclss/IATCSdown.png'
            size_hint: 0.15,0.13
            pos_hint: {"center_x": 0.75, "center_y": 0.9}
            on_release: root.manager.current = 'iatcs'
        Label:
            id: CabinTemp_label
            pos_hint: {"center_x": 0.7, "center_y": 0.78}
            text: 'Cabin Temperature (deg C):'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CabinTemp
            pos_hint: {"center_x": 0.9, "center_y": 0.78}
            text: '0.003'
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CabinPress_label
            pos_hint: {"center_x": 0.7, "center_y": 0.71}
            text: 'Cabin Pressure (Torr):'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CabinPress
            pos_hint: {"center_x": 0.9, "center_y": 0.71}
            text: '0.003'
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: AirlockPress_label
            pos_hint: {"center_x": 0.7, "center_y": 0.65}
            text: 'Airlock Pressure (Torr):'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: AirlockPress
            pos_hint: {"center_x": 0.9, "center_y": 0.65}
            text: '0.003'
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CrewlockPress_label
            pos_hint: {"center_x": 0.7, "center_y": 0.59}
            text: 'Crewlock Pressure (Torr):'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CrewlockPress
            pos_hint: {"center_x": 0.9, "center_y": 0.59}
            text: '0.003'
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CleanWater_label
            pos_hint: {"center_x": 0.7, "center_y": 0.53}
            text: 'Clean Water Tank (%):'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: CleanWater
            pos_hint: {"center_x": 0.9, "center_y": 0.53}
            text: '0.003'
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: WasteWater_label
            pos_hint: {"center_x": 0.7, "center_y": 0.47}
            text: 'Waste Water Tank (%):'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: WasteWater
            pos_hint: {"center_x": 0.9, "center_y": 0.47}
            text: '0.003'
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: O2genState_label
            pos_hint: {"center_x": 0.7, "center_y": 0.41}
            text: 'Oxygen Generator State:'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: O2genState
            pos_hint: {"center_x": 0.9, "center_y": 0.41}
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: O2prodRate_label
            pos_hint: {"center_x": 0.7, "center_y": 0.35}
            text: 'Oxygen Prod Rate:'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: O2prodRate
            pos_hint: {"center_x": 0.9, "center_y": 0.35}
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: VRSvlvPosition_label
            pos_hint: {"center_x": 0.7, "center_y": 0.29}
            text: 'VRS Valve:'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: VRSvlvPosition
            pos_hint: {"center_x": 0.9, "center_y": 0.29}
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: VESvlvPosition_label
            pos_hint: {"center_x": 0.7, "center_y": 0.23}
            text: 'VES Valve:'
            markup: True
            color: 1,1,1
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
        Label:
            id: VESvlvPosition
            pos_hint: {"center_x": 0.9, "center_y": 0.23}
            markup: True
            color: root.signalcolor
            size_hint_y: 0.4
            font_size: min(self.height * 0.10, dp(28))
                   # ---------- STATUS DISPLAY (Bottom Rectangle) ----------
        Label:
            id: status_label
            text: ''
            size_hint: 1, 0.07
            background_color: 0, 0, 0, 0.8  # Semi-transparent black
            color: 0, 1, 0, 1  # Green text
            font_size: self.height * 0.6  # Scale font to label height
            text_size: self.size
            halign: 'center'
            valign: 'middle'
            pos_hint: {"center_x": 0.57, "center_y": 0.07}
        
        # ---------- BOTTOM TOOLBAR ----------
        Image:
            id: signal
            source: f"{root.mimic_directory}/Mimic/Pi/imgs/signal/signalred.zip"
            size_hint_y: 0.112
            anim_delay: 0.05
            anim_loop: 0
            fit_mode: "scale-down"
            pos_hint: {"center_x": 0.05, "center_y": 0.07}
        
        Image:
            id: arduino
            source: f"{root.mimic_directory}/Mimic/Pi/imgs/signal/arduino_offline.png"
            size_hint_y: 0.15
            anim_delay: 0.2
            anim_loop: -1
            fit_mode: "scale-down"
            pos_hint: {"center_x": 0.14, "center_y": 0.08}
        
        Label:
            id: arduino_count
            pos_hint: {"center_x": 0.14, "center_y": 0.08}
            text: ''
            markup: True
            color: 1, 1, 1, 1
            font_size: self.height * 1
            size_hint: 0.06, 0.08
        
        # ─────────────────────── Navigation ────────────────────────────────

        Button:
            size_hint: 0.1, 0.11
            pos_hint: {"center_x": 0.9375, "center_y": 0.07}
            background_normal: f'{root.mimic_directory}/Mimic/Pi/imgs/eva/BackButton.png'
            background_down: f'{root.mimic_directory}/Mimic/Pi/imgs/eva/BackButton.png'
            border: 0,0,0,0    # avoid 9-slice margins
            on_release: app.root.current = 'mimic'